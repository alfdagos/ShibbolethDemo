<VirtualHost *:8080>
    ServerName localhost
    DocumentRoot /var/www/html

    # Proxy API requests to backend
    ProxyPass /api http://backend-service:8080/api
    ProxyPassReverse /api http://backend-service:8080/api

    # Proxy root requests to frontend service
    ProxyPass / http://frontend-service:8080/
    ProxyPassReverse / http://frontend-service:8080/

    <Location />
        AuthType shibboleth
        ShibRequestSetting requireSession true
        Require shib-session
        ShibUseHeaders On
    </Location>
    
    # Exclude /Shibboleth.sso from protection (handled by module)
    <Location /Shibboleth.sso>
        SetHandler shib
    </Location>

    ErrorLog /proc/self/fd/2
    CustomLog /proc/self/fd/1 combined
</VirtualHost>
